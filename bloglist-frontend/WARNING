This was written in part late at night because I refused to go to sleep before finishing part7. Therefore some of the code is terrible.
